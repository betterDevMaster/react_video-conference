(this["webpackJsonpvideo-meeting-front"]=this["webpackJsonpvideo-meeting-front"]||[]).push([[0],{104:function(e,t,a){},121:function(e,t,a){},124:function(e,t,a){},136:function(e,t,a){},137:function(e,t,a){},156:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),i=a(15),r=a.n(i),c=a(16),s=a(5),l=a(1),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{chat:"on",camera:"on",fullscreen:"on",mic:"on",screenshare:"on"},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"click_chat":return Object(l.a)(Object(l.a)({},e),{},{chat:t.value});case"click_camera":return Object(l.a)(Object(l.a)({},e),{},{camera:t.value});case"click_fullscreen":return Object(l.a)(Object(l.a)({},e),{},{fullscreen:t.value});case"click_mic":return Object(l.a)(Object(l.a)({},e),{},{mic:t.value});case"click_screenshare":return Object(l.a)(Object(l.a)({},e),{},{screenshare:t.value});default:return e}},u=a(8),m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"user_add":return e.find((function(e){return e.id===t.value.id}))?(console.log("Duplicate user error!",t.value),e):[].concat(Object(u.a)(e),[Object(l.a)(Object(l.a)({},t.value),{},{media:{mic:"on",camera:"on"}})]);case"user_remove":return e.filter((function(e){return e.id!==t.value.id}));case"user_media":return e.map((function(e){return e.id!==t.value.id?e:"mic"===t.value.type?Object(l.a)(Object(l.a)({},e),{},{media:Object(l.a)(Object(l.a)({},e.media),{},{mic:t.value.status})}):"camera"===t.value.type?Object(l.a)(Object(l.a)({},e),{},{media:Object(l.a)(Object(l.a)({},e.media),{},{camera:t.value.status})}):Object(l.a)(Object(l.a)({},e),{},{media:Object(l.a)(Object(l.a)({},e.media),{},{screenshare:t.value.status})})}));case"user_position":return e.map((function(e){return e.id!==t.value.id?e:Object(l.a)(Object(l.a)({},e),t.value)}));default:return e}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"chat_add":return setTimeout((function(){var e=document.getElementsByClassName("chatitemparent");e.length>0&&e[e.length-1].scrollIntoView({behavior:"smooth"})}),200),[].concat(Object(u.a)(e),[Object(l.a)(Object(l.a)({},t.value),{},{key:e.length})]);default:return e}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{bgMoving:!1,videos:[],images:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"backgound_moving":return Object(l.a)(Object(l.a)({},e),{},{bgMoving:t.value});case"youtube_add":var a=[].concat(Object(u.a)(e.videos),[t.value]);return Object(l.a)(Object(l.a)({},e),{},{videos:a});case"youtube_remove":var n=e.videos.filter((function(e){return e.name!==t.name}));return Object(l.a)(Object(l.a)({},e),{},{videos:n});case"youtube_remove_by_id":return Object(l.a)(Object(l.a)({},e),{},{videos:e.videos.filter((function(e){return e.id!==t.peerId}))});case"youtube_position":var o=e.videos.map((function(e){return e.name!==t.value.name?e:Object(l.a)(Object(l.a)({},e),t.value)}));return Object(l.a)(Object(l.a)({},e),{},{videos:o});case"youtube_play":var i=e.videos.map((function(e){return e.name!==t.value.name?e:Object(l.a)(Object(l.a)({},e),t.value)}));return Object(l.a)(Object(l.a)({},e),{},{videos:i});case"image_add":var r=[].concat(Object(u.a)(e.images),[t.value]);return Object(l.a)(Object(l.a)({},e),{},{images:r});case"image_remove_by_id":return Object(l.a)(Object(l.a)({},e),{},{images:e.images.filter((function(e){return e.id!==t.peerId}))});case"image_remove":var c=e.images.filter((function(e){return e.name!==t.name}));return Object(l.a)(Object(l.a)({},e),{},{images:c});case"image_position":var s=e.images.map((function(e){return e.name!==t.value.name?e:Object(l.a)(Object(l.a)({},e),t.value)}));return Object(l.a)(Object(l.a)({},e),{},{images:s});default:return e}},g=Object(c.b)({buttons:d,users:m,chats:v,screens:f}),p=(a(85),a(74)),h=a(11),b=(a(86),a(87),a(18)),y=a(13),E=(a(22),function(){function e(){Object(b.a)(this,e)}return Object(y.a)(e,null,[{key:"show",value:function(e){window.$("#"+e).plainModal("open")}}]),e}()),w=a(4),N=(a(88),a(51)),x=a(52),k=function(e){return o.a.createElement("div",{className:"fadeIn ".concat(e.spinning)},o.a.createElement(N.a,{icon:x.a,size:e.size}))},O=a(53),S=a.n(O),j=a(54),I=a.n(j);var _=function(e){var t=Object(n.useState)(!0),a=Object(w.a)(t,2),i=a[0],r=(a[1],Object(n.useState)(!1)),c=Object(w.a)(r,2),s=c[0],d=c[1],u=Object(n.useState)(2),m=Object(w.a)(u,2),v=m[0],f=m[1],g=Object(n.useState)(""),p=Object(w.a)(g,2),h=p[0],b=p[1],y=Object(n.useState)(""),E=Object(w.a)(y,2),N=E[0],x=E[1],O=Object(n.useState)(null),j=Object(w.a)(O,2),_=j[0],C=j[1],M=Object(n.useState)({email:"Enter your Email!",space:"Enter your Sspace Name!"}),P=Object(w.a)(M,2),T=P[0],D=P[1],R=RegExp(/^(([^<>()\],;:\s@]+([^<>()\],;:\s@]+)*)|(.+))@(([^<>()[\],;:\s@]+)+[^<>()[\],;:\s@]{2,})$/i),X=function(e){e.preventDefault();var t=e.target,a=t.name,n=t.value;switch(a){case"space":T.space=n.length<5?"Space Name must be 5 characters long!":"";break;case"email":T.email=R.test(n)?"":"Email is not valid!"}D(Object(l.a)(Object(l.a)({},T),{},{name:n}))},Y=function(e){e.preventDefault(),window.$("#roomdialog").plainModal("close"),setTimeout((function(){d(!1),f(2)}),100)};Object(n.useEffect)((function(){}),[v]);var B=o.a.createElement("form",{"data-v-9deb956c":"",className:"form",onSubmit:function(e){return e.preventDefault(),d(!0),void fetch("".concat("https://webrtc.bcisummit.com","/email"),{method:"pOSt",headers:{aCcePt:"aPpliCaTIon/JsOn","cOntENt-type":"applicAtion/JSoN"},body:JSON.stringify({email:h.value,space:N.value})}).then((function(e){return e.json()})).then((function(e){d(!1),f(e.status),_.reset()})).catch((function(e){return console.log(e)}))},ref:function(e){return C(e)},noValidate:!0},o.a.createElement("div",{"data-v-9deb956c":"",className:"label"},"Your Email"),o.a.createElement("input",{"data-v-9deb956c":"",type:"email",name:"email",className:"email",ref:function(e){return b(e)},onChange:function(e){return X(e)},noValidate:!0}),T.email.length>0&&o.a.createElement("span",{className:"error"},T.email),o.a.createElement("div",{"data-v-9deb956c":"",className:"label"},"Space Name"),o.a.createElement("input",{"data-v-9deb956c":"",type:"text",name:"space",className:"space-name",ref:function(e){return x(e)},onChange:function(e){return X(e)},noValidate:!0}),T.space.length>0&&o.a.createElement("span",{className:"error"},T.space),o.a.createElement("div",{id:"recaptcha"}),o.a.createElement("div",{"data-v-9deb956c":"",className:"buttons"},o.a.createElement("button",{"data-v-9deb956c":"",className:"cancel",onClick:function(e){return Y(e)}},"CANCEL"),o.a.createElement("button",{"data-v-9deb956c":"",type:"submit",className:"create",disabled:0!==function(e){var t=0;return delete e.name,Object.values(e).forEach((function(e){e.length>0&&(t+=1)})),t}(T)||!i},s?o.a.createElement(k,{size:"lg",spinning:"spinning"}):"CREATE"))),A=o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{"data-v-9deb956c":"",className:"created"},o.a.createElement("img",{src:S.a,alt:"successsvg"}),o.a.createElement("div",{"data-v-9deb956c":"",className:"text"},"Email sent!",o.a.createElement("h4",{"data-v-9deb956c":""},"Please check your inbox to confirm."))),o.a.createElement("div",{"data-v-9deb956c":"",className:"buttons"},o.a.createElement("button",{"data-v-9deb956c":"",className:"cancel",onClick:function(e){return Y(e)}},"GOT IT!"))),z=o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{"data-v-9deb956c":"",className:"created"},o.a.createElement("img",{src:I.a,alt:"error.svg"}),o.a.createElement("div",{"data-v-9deb956c":"",className:"text",style:{color:"#ff0000"}},"Whoops!",o.a.createElement("h4",{"data-v-9deb956c":""},"Already registered."))),o.a.createElement("div",{"data-v-9deb956c":"",className:"buttons"},o.a.createElement("button",{"data-v-9deb956c":"",className:"cancel",onClick:function(e){return Y(e)}},"GOT IT!")));return o.a.createElement("div",{"data-v-9deb956c":"","data-v-5c9875d0":"",id:"roomdialog","aria-expanded":"true","data-modal":"create-space",className:"create-space-modal v--modal-overlay roomdialog"},o.a.createElement("div",{className:"v--modal-background-click"},o.a.createElement("div",{className:"v--modal-top-right"}),o.a.createElement("div",{role:"dialog","aria-modal":"true",className:"v--modal-box modal m-dialog"},o.a.createElement("div",{"data-v-9deb956c":"",className:"header"},"Create Space"),2===v?B:0===v?A:z)))},C=o.a.memo((function(e){return o.a.createElement("div",{"data-v-3de1367d":"",className:"footer"},o.a.createElement("div",{"data-v-3de1367d":"",className:"links"},o.a.createElement("a",{"data-v-3de1367d":"",href:"https://mail.google.com/mail/?view=cm&fs=1&tf=1&to=seniordev119@gmail.com",className:"support-link",target:"_blank",rel:"noopener noreferrer"},"seniordev119@gmail.com"),o.a.createElement("span",{"data-v-3de1367d":"",className:"phone-hidden"},"\xa0\xa0\xa0\xa0\u2219\xa0\xa0\xa0\xa0"),o.a.createElement("div",{"data-v-3de1367d":"",className:"legal"},o.a.createElement("a",{"data-v-3de1367d":"",href:"https://www.notion.so/spatialchat/SpatialChat-Privacy-Policy-899c953609d24d3ebbd619506becaa7f",target:"_blank",rel:"noopener noreferrer"},"Privacy Policy"),o.a.createElement("span",{"data-v-3de1367d":""},"\xa0\xa0\xa0\xa0\u2219\xa0\xa0\xa0\xa0"),o.a.createElement("a",{"data-v-3de1367d":"",href:"https://www.notion.so/spatialchat/Terms-of-Service-6f9243e5e25346cfa73df618c90de4fb",target:"_blank",rel:"noopener noreferrer"},"Terms of Service"))))}));var M=function(e){return o.a.createElement("div",{"data-v-5c9875d0":"",className:"home"},o.a.createElement("div",{"data-v-5c9875d0":"",className:"buttons"},o.a.createElement("button",{"data-v-5c9875d0":"",onClick:function(){E.show("roomdialog")},className:"button"},"Create Space")),o.a.createElement(C,null),o.a.createElement(_,null))},P=a(38),T=a(25),D=a(12),R=a.n(D),X=a(55),Y=a(27),B=function(){function e(){Object(b.a)(this,e)}return Object(y.a)(e,null,[{key:"addPosition",value:function(e,t){return{x:e.x+t.x,y:e.y+t.y}}},{key:"multiplyPosition",value:function(e,t){return{x:e.x*t,y:e.y*t}}},{key:"getPositionFromTransform",value:function(e){try{var t=e.style.transform.match(/[+-]?\d+(?:\.\d+)?/g).map(Number);return{x:t[0],y:t[1]}}catch(a){return console.error(a),{x:0,y:0}}}},{key:"getPositionFromTransformWithScale",value:function(e){try{var t=e.style.transform.match(/[+-]?\d+(?:\.\d+)?/g).map(Number);return{x:t[0],y:t[1],scale:t[2]}}catch(a){return console.error(a),{x:0,y:0}}}},{key:"getPositionFromStyle",value:function(e){try{return{x:e.offsetLeft,y:e.offsetTop}}catch(t){return console.error(t),{x:0,y:0}}}},{key:"setPositionOfHtmlElement",value:function(e,t){try{return e.style.left=t.x+"px",e.style.top=t.y+"px",!0}catch(a){return console.error(a),!1}}},{key:"isInRect",value:function(e,t){try{return t.x>=e.left&&t.x<=e.right&&t.y>=e.top&&t.y<=e.bottom}catch(a){return console.error(a),!1}}},{key:"width",value:function(){return window.innerWidth?window.innerWidth:document.documentElement.clientWidth||document.body.clientWidth||0}},{key:"height",value:function(){return window.innerHeight?window.innerHeight:document.documentElement.clientHeight||document.body.clientHeight||0}}]),e}(),A=function(){function e(){Object(b.a)(this,e),this.client=null,this.roomName="",this.userName="",this.myPosition={x:0,y:0},this.youtubes=[],this.images=[],this.sharedUserId="",this.enableScreenShare=!0,this.enableCamera=!0,this.enableMic=!0,this.videoQualities=[{text:"SSM (30p - 128Kb/s)",value:{width:160,height:120,frameRate:10}},{text:"SM (120p - 256Kb/s)",value:{width:320,height:240,frameRate:10}},{text:"SD (360p - 1Mb/s)",value:{width:480,height:360,frameRate:10}},{text:"HD (720p - 2Mb/s)",value:{width:1280,height:720,frameRate:10}},{text:"Full HD (1080p - 4Mb/s)",value:{width:1920,height:1080,frameRate:15}}],this.currentVideoQuality=this.videoQualities[1],this.audioQualities=[{text:"Narrow Band (16Kb/s)",value:{sampleSize:8,channelCount:1}},{text:"Wide Band (64Kb/s)",value:{sampleSize:8,channelCount:2}},{text:"Full Band (256Kb/s)",value:{sampleSize:16,channelCount:2}}],this.currentAudioQuality=this.audioQualities[1],console.log("WebRTC class was initialized.")}return Object(y.a)(e,null,[{key:"getInstance",value:function(){return null===e._instance&&(e._instance=new e),e._instance}}]),Object(y.a)(e,[{key:"checkBrowser",value:function(){return window.Login._browserCompatCheck()}},{key:"getUserName",value:function(){var e=window.localStorage.getItem("userName");return e||""}},{key:"setUserName",value:function(e){window.localStorage.setItem("userName",e)}},{key:"getRoomName",value:function(){return this.roomName}},{key:"generateRoomName",value:function(){return window.generateRoomName()}},{key:"createRoom",value:function(e,t){window.localStorage.setItem("o",!0),window.localStorage.setItem("t","video-conference"),window.localStorage.setItem("r",t),window.location.href="/room?username="+this.getUserName()}},{key:"joinRoom",value:function(e,t){window.localStorage.setItem("o",!1),window.localStorage.setItem("t","video-conference"),window.localStorage.setItem("r",t),window.location.href="/room?username="+this.getUserName()}},{key:"createAudioMeter",value:function(t){var a=new AudioContext,n=a.createMediaStreamSource(t),o=a.createScriptProcessor(16384,1,1);n.connect(o),o.connect(a.destination),o.onaudioprocess=function(t){var a=t.inputBuffer;if(a.numberOfChannels>0){for(var n=a.getChannelData(0),o=n.length,i=0,r=0;r<o;r+=16)i+=Math.abs(n[r]);var c=Math.sqrt(16*i/o);window.easyrtc.sendPeerMessage({targetRoom:e.getInstance().roomName},"audio-meter",{rms:c})}}}},{key:"toggleCamera",value:function(e){this.enableCamera=e,this.onStreamConfigurationChange(),this.client&&this.client.sendPeerMessage({room:this.roomName},"media-presence",{type:"camera",status:e?"on":"off"})}},{key:"toggleMic",value:function(e){this.enableMic=e,this.onStreamConfigurationChange(),this.client&&this.client.sendPeerMessage({room:this.roomName},"media-presence",{type:"mic",status:e?"on":"off"})}},{key:"toggleScreenShare",value:function(t){this.enableScreenShare=t,t?e.getInstance().onStreamConfigurationChange():e.getInstance().onSetScreenCapture(),this.client&&this.client.sendPeerMessage({room:this.roomName},"media-presence",{type:"screenshare",status:t?"on":"off"})}},{key:"youtubePosition",value:function(e){this.youtubes.forEach((function(t){t.name===e.name&&(t.transform=e.transform,t.defX=e.defX,t.defY=e.defY,t.width=e.width,t.height=e.height)})),console.log("------------youtubePosition",e,this.youtubes),this.client&&this.client.sendPeerMessage({room:this.roomName},"youtube-position",e)}},{key:"youtubePlay",value:function(e){this.youtubes.forEach((function(t){t.name===e.name&&(t.videoplay=e.videoplay,t.videoplaying=e.videoplaying,t.curtime=e.curtime)})),this.client&&this.client.sendPeerMessage({room:this.roomName},"youtube-play",e)}},{key:"youtubeAdd",value:function(t){e.getInstance().youtubes.push(t),e.getInstance().client&&e.getInstance().client.sendPeerMessage({room:this.roomName},"youtube-add",t)}},{key:"youtubeRemove",value:function(t){e.getInstance().client&&e.getInstance().client.sendPeerMessage({room:this.roomName},"youtube-remove",t),e.getInstance().youtubes=e.getInstance().youtubes.filter((function(e){return e.name!==t.name}))}},{key:"imageAdd",value:function(t){e.getInstance().images.push(t),e.getInstance().client&&e.getInstance().client.sendPeerMessage({room:this.roomName},"image-add",t)}},{key:"imagePosition",value:function(e){this.images.forEach((function(t){t.name===e.name&&(t.transform=e.transform,t.defX=e.defX,t.defY=e.defY,t.width=e.width,t.height=e.height)})),this.client&&this.client.sendPeerMessage({room:this.roomName},"image-position",e)}},{key:"imageRemove",value:function(t){e.getInstance().client&&e.getInstance().client.sendPeerMessage({room:this.roomName},"image-remove",t),e.getInstance().images=e.getInstance().images.filter((function(e){return e.name!==t.name}))}},{key:"closeClient",value:function(e){this.dispatch({type:"user_remove",value:{id:e}}),window.easyrtc.disconnect()}},{key:"sendFile",value:function(e,t,a){var n=window.$("#file");n.one("change",(function(){var o=n[0].files[0];if(0!==o.size)if(o.size>Math.pow(2,21))alert("File size can't be larger than 2MB.");else{var i=new FileReader;i.onload=function(n){var i={name:o.name,type:o.type,size:o.size,binaryContents:n.target.result};a({type:"chat_add",value:{username:"Me",userid:"me",text:'Send a file "'.concat(o.name,'" to "').concat(t,'".'),align:"right",time:Date.now()}}),window.easyrtc.sendDataWS(e,"file",i)},i.readAsDataURL(o),n[0].value=""}else alert("Empty file selected.")})),n[0].click()}},{key:"updateStreamMode",value:function(){var e={video:!1,audio:!1};this.currentVideoDevice&&(e.video={},e.video.deviceId=this.currentVideoDevice.value,e.video.width=this.currentVideoQuality.value.width,e.video.height=this.currentVideoQuality.value.height,e.video.frameRate=this.currentVideoQuality.value.frameRate),this.currentAudioDevice&&(e.audio={},e.audio.deviceId=this.currentAudioDevice.value,e.audio.sampleSize=this.currentAudioQuality.value.sampleSize,e.audio.channelCount=this.currentAudioQuality.value.channelCount),this.currentContraintMode=e}},{key:"onStreamConfigurationChange",value:function(t){if(this.enableScreenShare){this.updateStreamMode();var a=window.easyrtc.getLocalStream();a.getTracks().forEach((function(e){e.stop()}));var n=Object(l.a)({},this.currentContraintMode);if(e.getInstance().enableCamera||(n.video=!1),e.getInstance().enableMic||(n.audio=!1),n.video||n.audio)navigator.mediaDevices.getUserMedia(n).then((function(t){t.getTracks().forEach((function(e){a.addTrack(e)}));var n=document.getElementById(a.id);n&&window.easyrtc.setVideoObjectSrc(n,t),window.easyrtc.enableCamera(e.getInstance().enableCamera),window.easyrtc.enableMicrophone(e.getInstance().enableMic);var o=window.easyrtc.getPeerConnections();for(var i in o){o[i].pc.getSenders().forEach((function(e){var a=e.track.kind,n=t.getTracks().find((function(e){return e.kind===a}));n?(e.replaceTrack(n),e.track.enabled=!0):e.track.enabled=!1}))}}));else{var o=window.easyrtc.getPeerConnections();for(var i in o){o[i].pc.getSenders().forEach((function(e){e.track&&(e.track.enabled=!1)}))}}}else{var r=window.easyrtc.getPeerConnections();for(var c in r){r[c].pc.getSenders().map((function(t){e.getInstance().screenStream&&t.replaceTrack(e.getInstance().screenStream.getTracks().find((function(e){return e.kind===t.track.kind})))}))}}}},{key:"updateDevices",value:function(){var e=Object(Y.a)(R.a.mark((function e(){var t,a,n,o,i,r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=[],a=[],e.next=5,navigator.mediaDevices.enumerateDevices();case 5:n=e.sent,o=Object(X.a)(n);try{for(r=function(){var e=i.value;if("audioinput"===e.kind){var n=t.filter((function(t){return 0===t.text.indexOf(e.label)}));t=n.length>0?[].concat(Object(u.a)(t),[{text:e.label+"-"+n.length,value:e.deviceId}]):[].concat(Object(u.a)(t),[{text:e.label,value:e.deviceId}])}if("videoinput"===e.kind){var o=a.filter((function(t){return 0===t.text.indexOf(e.label)}));a=o.length>0?[].concat(Object(u.a)(a),[{text:e.label+"-"+o.length,value:e.deviceId}]):[].concat(Object(u.a)(a),[{text:e.label,value:e.deviceId}])}},o.s();!(i=o.n()).done;)r()}catch(c){o.e(c)}finally{o.f()}this.videoDevices=a,this.audioDevices=t,e.next=14;break;case 12:e.prev=12,e.t0=e.catch(0);case 14:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"startConference",value:function(){var t=Object(Y.a)(R.a.mark((function t(a,n,o,i,r){var c=this;return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("start conference: ",i,r),this.userName=i,this.roomName=o||window.localStorage.getItem("r"),this.roomName){t.next=6;break}return window.location.href="/room?space="+this.roomName,t.abrupt("return");case 6:return this.dispatch=a,t.next=9,this.updateDevices();case 9:this.currentVideoDevice=0===this.videoDevices.length?null:this.videoDevices[0],this.currentAudioDevice=0===this.audioDevices.length?null:this.audioDevices[0],this.owner=window.localStorage.getItem("o"),this.token=window.localStorage.getItem("t"),window.localStorage.removeItem("o"),window.localStorage.removeItem("t"),window.localStorage.removeItem("r"),window.easyrtc.enableDataChannels(!1),window.VTCCore.initialize({cameraIsEnabled:!0,micIsEnabled:!0}).onError((function(e){console.log("error---",e)})).onPeerMessage((function(t,n,o,i){if("chat"===o)a({type:"chat_add",value:{username:t.idToName(n),userid:n,text:i,align:"left",time:Date.now()}});else if("set_peer_position"===o)e.getInstance().updatePeerPosition(i);else if("youtube-position"===o)a({type:"youtube_position",value:{username:t.idToName(n),name:i.name,videoId:n,transform:i.transform,width:i.width,height:i.height,defX:i.defX,defY:i.defY}});else if("youtube-play"===o)a({type:"youtube_play",value:{name:i.name,videoplay:i.videoplay,curtime:i.curtime,videoplaying:i.videoplaying}});else if("youtube-add"===o)a({type:"youtube_add",value:{name:i.name,id:n,value:i.videoId,transform:i.transform,width:i.width,height:i.height,defX:i.defX,defY:i.defY}});else if("youtube-remove"===o)console.log("youtbut_remove: ",i),a({type:"youtube_remove",name:i.name});else if("image-position"===o)a({type:"image_position",value:{username:t.idToName(n),name:i.name,imageid:n,transform:i.transform,width:i.width,height:i.height,defX:i.defX,defY:i.defY}});else if("image-add"===o)a({type:"image_add",value:{name:i.name,id:n,value:i.imageId,transform:i.transform,width:i.width,height:i.height,defX:i.defX,defY:i.defY}});else if("image-remove"===o)a({type:"image_remove",name:i.name});else if("media-presence"===o&&"string"===typeof i.type&&"string"===typeof i.status){setTimeout((function e(){document.getElementById("screen_"+n)?a({type:"user_media",value:{id:n,type:"screenshare",status:i.status}}):setTimeout(e,500)}),500)}else if("debug"===o)console.log(o,n,i);else{if("mic-control"===o&&"boolean"===typeof i.enabled)return void console.log(t,n,o,i);if("audio-meter"===o);else if("file"===o){for(var r=i.binaryContents.split(","),c=r[0].match(/:(.*?);/)[1],s=atob(r[1]),l=s.length,d=new Uint8Array(l);l--;)d[l]=s.charCodeAt(l);var u=new Blob([d],{type:c});a({type:"chat_add",value:{username:t.idToName(n),userid:n,html:'"'.concat(t.idToName(n),"\" sent a file.<br><a href='").concat(URL.createObjectURL(u),"' target='_blank'>Click here to download ").concat(i.name,"(").concat(i.size,"bytes)"),align:"left",time:Date.now()}})}else console.log("peerMessage => got a peer message that is unexpected"),console.log("            => peerId:  "+n),console.log("            =>   name: "+t.idToName(n)),console.log("            => msgType: "+o),console.log("            => content: "+JSON.stringify(i))}})).onStreamAccept((function(t,n,o){var i=t.idToName(n);window.easyrtc.sendServerMessage("get_peer_position",n,(function(t,r){console.log("onStreamAccept: ",i,"roomName = ",e.getInstance().roomName),a({type:"user_add",value:{id:n,name:i,stream:o,defPosX:r.x,defPosY:r.y}}),e.getInstance().onStreamConfigurationChange(n)}),(function(e,t){})),e.getInstance().youtubes.forEach((function(t){e.getInstance().client.sendPeerMessage({rtcId:n},"youtube-add",t),e.getInstance().client.sendPeerMessage({rtcId:n},"youtube-play",t),e.getInstance().client.sendPeerMessage({rtcId:n},"youtube-position",t)})),e.getInstance().images.forEach((function(t){e.getInstance().client.sendPeerMessage({rtcId:n},"image-add",t),e.getInstance().client.sendPeerMessage({rtcId:n},"image-position",t)})),e.getInstance().client.sendPeerMessage({room:e.getInstance().roomName},"media-presence",{type:"screenshare",status:e.getInstance().enableScreenShare?"on":"off"})})).onStreamClose((function(e,t){console.log("streamClose"),a({type:"image_remove_by_id",peerId:t}),a({type:"youtube_remove_by_id",peerId:t}),a({type:"user_remove",value:{id:t}})})).connect(i,this.roomName,(function(t){console.log("start local stream: ",i,"roomName = ",c.roomName);var n=t.getLocalStream();window.easyrtc.sendServerMessage("get_my_position",{clientId:t.getId(),sWidth:B.width(),sHeight:B.height()},(function(o,i){a({type:"user_add",value:{id:"me",name:"Me",stream:n,defPosX:i.x,defPosY:i.y}}),e.getInstance().onStreamConfigurationChange(),e.getInstance().client=t,e.getInstance().updateMyPosition(i)}),(function(e,t){}))}));case 18:case"end":return t.stop()}}),t,this)})));return function(e,a,n,o,i){return t.apply(this,arguments)}}()},{key:"removeChild",value:function(e,t){console.log("----------removeChild");var a=document.getElementById("screen_"+e),n=e.videoEl;a&&n&&a.removeChild(n)}},{key:"sendMessage",value:function(e){this.client.sendPeerMessage({room:this.roomName},"chat",e)}},{key:"onSetScreenCapture",value:function(){var t=this;this.updateStreamMode();var a=window.easyrtc.getLocalStream(),n=this;navigator.mediaDevices.getDisplayMedia({video:{width:1920,height:1080,frameRate:5}}).then(function(){var n=Object(Y.a)(R.a.mark((function n(o){var i,r,c,s,l;return R.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a.getTracks().forEach((function(e){e.stop()})),n.next=3,navigator.mediaDevices.getUserMedia({audio:!0});case 3:i=n.sent,o.getVideoTracks()[0].onended=function(){t.toggleScreenShare(!0),t.dispatch({type:"click_screenshare",value:"on"}),t.dispatch({type:"user_media",value:{id:"me",type:"screenshare",status:"on"}}),document.getElementById("screenshare").src="/static/media/screenshare-on.44d81ce8.svg"},o.addTrack(i.getAudioTracks()[0]),o.getTracks().forEach((function(e){a.addTrack(e)})),e.getInstance().screenStream=o,r=document.getElementById(a.id),window.easyrtc.setVideoObjectSrc(r,o),c=window.easyrtc.getPeerConnections(),n.t0=R.a.keys(c);case 12:if((n.t1=n.t0()).done){n.next=20;break}if(s=n.t1.value,!(l=c[s]).cancelled){n.next=17;break}return n.abrupt("continue",12);case 17:l.pc.getSenders().map((function(e){return e.replaceTrack(o.getTracks().find((function(t){return t.kind===e.track.kind})))})),n.next=12;break;case 20:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(e){console.log(e),"NotFoundError"===e.name||"DevicesNotFoundError"===e.name?console.log("NotFoundError, DevicesNotFoundError"):"NotReadableError"===e.name||"TrackStartError"===e.name?console.log("NotReadableError, TrackStartError"):"OverconstrainedError"===e.name||"ConstraintNotSatisfiedError"===e.name?console.log("OverconstrainedError, ConstraintNotSatisfiedError"):"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?(console.log("Send screen share message"),n.toggleScreenShare(!0),n.dispatch({type:"click_screenshare",value:"on"}),n.dispatch({type:"user_media",value:{id:"me",type:"screenshare",status:"on"}}),document.getElementById("screenshare").src="/static/media/screenshare-on.44d81ce8.svg"):"TypeError"===e.name||"TypeError"===e.name?console.log("TypeError"):console.log("Error: "+e.name)}))}},{key:"updatePeerPosition",value:function(t){e.getInstance().dispatch({type:"user_position",value:{id:t.position.peerId,defPosX:t.position.x,defPosY:t.position.y}})}},{key:"updateMyPosition",value:function(e){this.client&&(e||(e=this.myPosition),this.myPosition=e,this.client.sendPeerMessage({room:this.roomName},"set_peer_position",{id:this.client.getId(),position:this.myPosition}))}}]),e}();A._instance=null;var z=A,F=(a(104),o.a.memo((function(e){return o.a.createElement("img",{id:e.id,"data-v-2f32af68":"",className:"stopvideo pointer has-tooltip",src:e[e.status],alt:e.alt,title:e.alt,onClick:function(){e.onClick&&"no"!==e.status&&e.onClick()}})}))),V=a(56),L=a.n(V);var U=function(e){var t=Object(s.b)(),a=Object(n.useState)(""),i=Object(w.a)(a,2),r=i[0],c=i[1],l=Object(n.useState)(!1),d=Object(w.a)(l,2),u=d[0],m=d[1],v=function(e){if(!1!==function(e){return!!e.match(/^(?:https?:\/\/)?(?:www\.)?youtube\.com\/watch\?(?=.*v=((\w|-){11}))(?:\S+)?$/)&&RegExp.$1}(r.value))m(!0);else{m(!1);var t=document.getElementsByClassName("input-text");t[0].className+=" error",t[0].textContent="Incorrect link"}};return o.a.createElement("div",{"data-v-6a2f6b36":"","data-v-6e496afa":"",id:"videodialog","aria-expanded":"true","data-modal":"add-youtube",className:"add-youtube-modal v--modal-overlay customDlgPos"},o.a.createElement("div",{className:"v--modal-background-click"},o.a.createElement("div",{className:"v--modal-top-right"}),o.a.createElement("div",{role:"dialog","aria-modal":"true",className:"v--modal-box modal videodialog"},o.a.createElement("img",{"data-v-6a2f6b36":!0,className:"logo",src:L.a,alt:"youtube.svg"}),o.a.createElement("div",{"data-v-6a2f6b36":"",className:"input-text"},"YouTube video link"),o.a.createElement("input",{"data-v-6a2f6b36":"",type:"text",name:"video",className:"url",ref:function(e){return c(e)},onChange:function(e){return v()}}),o.a.createElement("div",{"data-v-6a2f6b36":"",className:"buttons"},o.a.createElement("input",{"data-v-6a2f6b36":"",type:"button",value:"CANCEL",className:"cancel",onClick:function(e){window.$("#videodialog").plainModal("close")}}),o.a.createElement("input",{"data-v-6a2f6b36":"",type:"submit",value:"OK",className:"ok",onClick:function(a){return function(a){var n=document.getElementsByClassName("input-text");n[0].textContent="YouTube video link",n[0].className=n[0].className.replace(/\berror\b/g,"");var o=function(e){var t=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/);return t&&11===t[2].length?t[2]:null}(r.value),i=document.getElementsByClassName("react-transform-element")[0],c=B.getPositionFromTransformWithScale(i),s=(Math.abs(-c.x)+B.width()/2-125*c.scale)/c.scale,l=(Math.abs(-c.y)+B.height()/2-70*c.scale)/c.scale;t({type:"youtube_add",value:{name:o,id:"me",transform:"translate(".concat(s,"px, ").concat(l,"px)"),username:e.uname,value:o,width:250,height:140,defX:s,defY:l}}),z.getInstance().youtubeAdd({videoId:o,name:o,transform:"translate(".concat(s,"px, ").concat(l,"px)"),username:e.uname,width:250,height:140,defX:s,defY:l}),r.value="",window.$("#videodialog").plainModal("close")}()},disabled:!u})))))},W=a(57),H=a.n(W);var Q=function(e){var t=Object(n.useState)(null),a=Object(w.a)(t,2),i=a[0],r=a[1],c=Object(n.useState)(!0),l=Object(w.a)(c,2),d=l[0],u=l[1],m=Object(n.useState)(""),v=Object(w.a)(m,2),f=v[0],g=v[1],p=Object(s.b)(),h=function(e){var t=document.getElementsByClassName("label");H()(e.target.value)||function(e){var t=new XMLHttpRequest;return t.open("HEAD",e,!1),t.send(),404!==t.status}(e.target.value)?(t[0].className=t[0].className.replace(/\berror\b/g,""),t[0].textContent="Image link",r(e.target.value),g(e.target.value)):(t[0].className+=" error",t[0].textContent="Incorrect link")},b=o.a.createElement("div",{"data-v-bd733764":"",className:"upload-computer tab-active drop-zone","data-id":"upload1"},o.a.createElement("div",{"data-v-bd733764":"",className:"bold"},"Drag and drop, paste image here"),o.a.createElement("div",{"data-v-bd733764":"",className:"gray"},"or"),o.a.createElement("input",{type:"file",name:"file-4",id:"file-4",className:"inputfile",onChange:function(e){return function(e){var t=new FileReader;g(e.target.files[0].name),t.onloadend=function(){r(t.result)},t.readAsDataURL(e.target.files[0])}(e)}}),o.a.createElement("label",{htmlFor:"file-4"},"BROWSE...")),y=o.a.createElement("div",{"data-v-bd733764":"",className:"preview"},o.a.createElement("img",{className:"imgPreview",src:i,height:"200",alt:"preview..."})),E=o.a.createElement("div",{"data-v-bd733764":"",className:"upload-link"},o.a.createElement("div",{"data-v-bd733764":"",className:"label"},"Image link"),o.a.createElement("input",{"data-v-bd733764":"",type:"text",className:"link",onChange:function(e){return h(e)}}));return o.a.createElement("div",{"data-v-bd733764":"","data-v-6e496afa":"",id:"imagedialog","aria-expanded":"true","data-modal":"add-image",className:"add-image-modal v--modal-overlay customDlgPos"},o.a.createElement("div",{className:"v--modal-background-click"},o.a.createElement("div",{className:"v--modal-top-right"}),o.a.createElement("div",{role:"dialog","aria-modal":"true",className:"v--modal-box modal imagedialog"},o.a.createElement("div",{"data-v-bd733764":"",className:"header"},o.a.createElement("button",{"data-v-bd733764":"","data-id":"upload1",className:"image_upload active",onClick:function(e){return function(e){u(!0);var t=document.getElementsByClassName("image_upload"),a=document.getElementsByClassName("image_link");a[0].className=a[0].className.replace(/\bactive\b/g,""),t[0].className+=" active"}()}},"Upload"),o.a.createElement("button",{"data-v-bd733764":"","data-id":"upload2",className:"image_link",onClick:function(e){return function(e){u(!1);var t=document.getElementsByClassName("image_upload"),a=document.getElementsByClassName("image_link");t[0].className=t[0].className.replace(/\bactive\b/g,""),a[0].className+=" active"}()}},"URL")),d&&i?y:d&&!i?b:null,!d&&i?y:d||i?null:E,o.a.createElement("div",{"data-v-bd733764":"",className:"buttons"},o.a.createElement("input",{"data-v-bd733764":"",type:"button",value:"CANCEL",className:"cancel",onClick:function(e){return e.preventDefault(),window.$("#imagedialog").plainModal("close"),void r(null)}}),i&&o.a.createElement("input",{"data-v-bd733764":"",type:"submit",value:"OK",className:"ok",onClick:function(t){return function(t){var a=document.getElementsByClassName("react-transform-element")[0],n=B.getPositionFromTransformWithScale(a),o=(Math.abs(-n.x)+B.width()/2-115*n.scale)/n.scale,c=(Math.abs(-n.y)+B.height()/2-65*n.scale)/n.scale;p({type:"image_add",value:{name:f,id:"me",username:e.uname,value:i,transform:"translate(".concat(o,"px, ").concat(c,"px)"),width:230,height:130,defX:o,defY:c}}),z.getInstance().imageAdd({imageId:i,name:f,username:e.uname,transform:"translate(".concat(o,"px, ").concat(c,"px)"),width:230,height:130,defX:o,defY:c}),r(null),window.$("#imagedialog").plainModal("close")}()}})))))},$=a(58),q=a.n($),K=a(28),J=a.n(K),G=a(29),Z=a.n(G),ee=a(39),te=a.n(ee),ae=a(59),ne=a.n(ae),oe=a(60),ie=a.n(oe),re=a(40),ce=a.n(re),se=a(61),le=a.n(se),de=a(41),ue=a.n(de),me=a(34),ve=a.n(me),fe=a(35),ge=a.n(fe),pe=a(62),he=a.n(pe),be=a(63),ye=a.n(be),Ee=(a(121),o.a.memo((function(e){var t=Object(s.b)(),a=Object(s.c)((function(e){return e.users})),n=Object(s.c)((function(e){return e.buttons.camera})),i=Object(s.c)((function(e){return e.buttons.mic})),r=Object(s.c)((function(e){return e.buttons.screenshare})),c=function(e,a){if(t({type:e,value:"on"===a?"off":"on"}),"click_camera"===e)t({type:"user_media",value:{id:"me",type:"camera",status:"on"===a?"off":"on"}}),z.getInstance().toggleCamera("off"===a);else if("click_mic"===e)t({type:"user_media",value:{id:"me",type:"mic",status:"on"===a?"off":"on"}}),z.getInstance().toggleMic("off"===a);else if("click_screenshare"===e){if(!document.getElementById("screen_me"))return;t({type:"user_media",value:{id:"me",type:"screenshare",status:"on"===a?"off":"on"}}),z.getInstance().toggleScreenShare("off"===a)}};return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{"data-v-2db9ff64":"",className:"app-header","data-v-12a888fb":""},o.a.createElement("a",{"data-v-2db9ff64":"",href:"/",target:"_blank"},o.a.createElement("img",{"data-v-2db9ff64":"",className:"logo",src:ve.a,alt:"logosvg",style:{display:"none"}}),o.a.createElement("img",{"data-v-2db9ff64":"",className:"logo-small",src:ge.a,alt:"logosmallsvg",style:{display:"none"}})),o.a.createElement("div",{"data-v-2f32af68":"",className:"controls"},o.a.createElement("div",{"data-v-2f32af68":"",className:"controls-main"},o.a.createElement("div",{"data-v-261ef19f":"","data-v-2f32af68":"",className:"members-container"},o.a.createElement("div",{"data-v-2f32af68":"","data-v-261ef19f":"",className:"members cus-dropdown"},o.a.createElement("img",{"data-v-2f32af68":"",src:q.a,alt:"userssvg"}),o.a.createElement("span",{"data-v-2f32af68":"","data-v-261ef19f":""},a.length),o.a.createElement("div",{"data-v-261ef19f":"",className:"cus-dropdown-content"},a.map((function(e){return"me"!==e.id?o.a.createElement("span",{key:e.id},e.name):null}))))),o.a.createElement(F,{on:J.a,off:J.a,no:J.a,alt:"Youtube",status:"on",onClick:function(){E.show("videodialog")}}),o.a.createElement(F,{on:Z.a,off:Z.a,no:Z.a,alt:"Uploadimage",status:"on",onClick:function(){E.show("imagedialog")}}),o.a.createElement(F,{on:te.a,off:ne.a,no:te.a,id:"screenshare",alt:"Screenshare",status:r,onClick:function(){return c("click_screenshare",r)}}),o.a.createElement(F,{on:ie.a,off:ce.a,no:ce.a,alt:"Camera",status:n,onClick:function(){return c("click_camera",n)}}),o.a.createElement(F,{on:le.a,off:ue.a,no:ue.a,alt:"Mic",status:i,onClick:function(){return c("click_mic",i)}})),o.a.createElement("a",{"data-v-2f32af68":"",href:"mailto:support@spatial.chat",className:"support-link"},o.a.createElement("img",{"data-v-2f32af68":"",className:"support has-tooltip",src:he.a,alt:"support"})),o.a.createElement("img",{"data-v-2f32af68":"",className:"close pointer",src:ye.a,alt:"close",onClick:function(t){return z.getInstance().closeClient("me"),void(window.location.href="/room?space="+e.query.space)}}))),o.a.createElement(U,{uname:e.query.uname}),o.a.createElement(Q,{uname:e.query.uname}))}))),we=a(19),Ne=(a(124),o.a.memo((function(e){var t="screen_"+e.user.id,a=(e.user.id,o.a.useRef(null)),i=Object(s.b)(),r=Object(n.useState)(0),c=Object(w.a)(r,2),l=c[0],d=c[1],u=Object(n.useState)(0),m=Object(w.a)(u,2),v=m[0],f=m[1];function g(){var e=document.getElementsByTagName("VIDEO"),t=B.getPositionFromTransform(e[0].parentElement.parentElement);if(e.length>1)for(var a=1;a<e.length;a++)p(t,e[a])}function p(e,t){if(t){var a=B.getPositionFromTransform(t.parentElement.parentElement),n=Math.max(1,Math.sqrt((e.x-a.x)*(e.x-a.x)+(e.y-a.y)*(e.y-a.y))),o=Math.max(.3,Math.min(1,150/n));t.parentElement.parentElement.style.transform="translate(".concat(a.x,"px, ").concat(a.y,"px) scale(").concat(o,")");var i=0===n?1:Math.max(0,Math.min(1,Math.pow(100/n,3)));i<.01&&(i=0),t.volume=isFinite(i)?i:1}}Object(n.useEffect)((function(){var t=document.getElementById(e.user.stream.id);t&&window.easyrtc.setVideoObjectSrc(t,e.user.stream)}),[]);function h(e,t){return e>=B.width()-80-10&&(e=B.width()-80-10),e<10&&(e=10),t>=B.height()-80-10&&(t=B.height()-80-10),t<30&&(t=30),{x:e,y:t}}if(a.current&&"me"!=e.user.id){var b=h(e.user.defPosX,e.user.defPosY),y=b.x,E=b.y;a.current.parentNode.style.transform="translate(".concat(y,"px, ").concat(E,"px)"),g()}return Object(n.useEffect)((function(){g()}),[e.curScale]),o.a.createElement(o.a.Fragment,null,o.a.createElement(we.a,{noderef:a,default:{x:e.user.defPosX,y:e.user.defPosY},onDragStart:function(e,t){var a;a=t,window.dragStart=!0,i({type:"backgound_moving",value:!0}),d(a.x),f(a.y)},onDrag:function(e,t){!function(e,t){var a=document.getElementsByTagName("VIDEO"),n={x:t.x,y:t.y};if(a.length>1)for(var o=1;o<a.length;o++)p(n,a[o])}(0,t)},onDragStop:function(e,t){var a;h(t.x,t.y),a=t,window.dragStart=!1,i({type:"backgound_moving",value:!1}),z.getInstance().myPosition.x+=a.x-l,z.getInstance().myPosition.y+=a.y-v,z.getInstance().updateMyPosition()},scale:e.curScale,style:{zIndex:"me"===e.user.id?50:25},lockAspectRatio:!0,enableResizing:!1,disableDragging:"me"!=e.user.id},o.a.createElement("div",{ref:a,id:t,"data-tip":!0,"data-for":e.user.id,key:e.user.id,className:"screen",style:{width:80,height:80,borderRadius:"50%",marginLeft:-40,marginTop:-40,border:"me"===e.user.id?"2px solid #dcdb53":"2px solid"},tabIndex:0},o.a.createElement("video",{className:"video",id:e.user.stream.id,controls:"",loop:"",muted:"me"===e.user.id,onMouseMove:function(t){var a=document.getElementById("div_tip");a.style.left=t.screenX+"px",a.style.top=t.screenY-150+"px",a.innerHTML=e.user.name,a.style.display="inline-block"},onMouseOut:function(e){document.getElementById("div_tip").style.display="none"}}))))}))),xe=a(24),ke=a(66),Oe=(a(136),a(42)),Se=a.n(Oe),je=a(69),Ie=a.n(je),_e=a(26),Ce=a.n(_e),Me=o.a.memo((function(e){var t,a=o.a.useRef(null),i=Object(n.useRef)(null),r=Object(n.useState)("off"),c=Object(w.a)(r,2),l=c[0],d=c[1],u=Object(s.b)(),m="youtubeAudio_"+e.video.value,v="video_"+e.video.value;Object(n.useEffect)((function(){setTimeout(g,500)}),[]);var f=function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))};function g(){var t=document.getElementById("screen_me"),a=document.getElementById("video_"+e.video.value);if(t&&a){var n=B.getPositionFromTransform(t.parentElement),o=B.getPositionFromTransform(a.parentNode),r=a.parentNode.clientWidth,c=a.parentNode.clientHeight,s=function(e,t){var a=-1;return t.x>e.left&&t.x<e.right&&(a=Math.min(Math.abs(t.y-e.top),Math.abs(t.y-e.bottom))),t.y>e.top&&t.y<e.bottom&&(a=-1===a?Math.min(Math.abs(t.x-e.left),Math.abs(t.x-e.right)):0),a>=0?a:Math.min(Math.min(f(t,{x:e.left,y:e.top}),f(t,{x:e.left,y:e.bottom})),Math.min(f(t,{x:e.right,y:e.top}),f(t,{x:e.right,y:e.bottom})))}({left:o.x,right:o.x+r,top:o.y,bottom:o.y+c},n),l=0===s?1:Math.max(0,Math.min(1,Math.pow(100/s,4)));l<.01&&(l=0),i&&i.current&&i.current.internalPlayer.setVolume(100*l*("on"===a.muted||void 0===a.muted?1:0))}setTimeout(g,1e3)}var p=function(t,n,o,i){u({type:"backgound_moving",value:!1}),z.getInstance().youtubePosition({transform:a.current.parentNode.style.transform,name:e.video.name,width:o,height:i,defX:t,defY:n}),u({type:"youtube_position",value:{transform:a.current.parentNode.style.transform,name:e.video.name,width:o,height:i,defX:t,defY:n}})};function h(e,t,a,n){return e>=B.width()-a-10&&(e=B.width()-a-10),e<10&&(e=10),t>=B.height()-n-10&&(t=B.height()-n-10),t<30&&(t=30),{x:e,y:t}}if("me"!=e.video.id&&i.current&&(e.video.videoplay&&e.video.videoplaying?(i.current.internalPlayer.unMute(),u({type:"youtube_play",value:{name:e.video.name,videoplay:!0,curtime:t,videoplaying:!1}}),z.getInstance().youtubePlay({name:e.video.name,videoplay:!0,curtime:t,videoplaying:!1}),i.current.internalPlayer.seekTo(e.video.curtime),i.current.internalPlayer.playVideo()):e.video.videoplay||e.video.videoplaying||i.current.internalPlayer.pauseVideo()),a.current&&!e.video.transform&&e.video.defX&&(a.current.parentNode.style.transform="translate(".concat(e.video.defX,"px, ").concat(e.video.defY,"px)")),a.current&&e.video.transform){a.current.parentNode.style.width=e.video.width+"px",a.current.parentNode.style.height=e.video.height+"px";var b=e.video.transform.match(/[+-]?\d+(?:\.\d+)?/g).map(Number),y=h(b[0],b[1],e.video.width,e.video.height),E=y.x,N=y.y;a.current.parentNode.style.transform="translate(".concat(E,"px, ").concat(N,"px)"),e.video.defX=E,e.video.defY=N}console.log(e.video);return o.a.createElement(we.a,{noderef:a,size:{width:e.video.width,height:e.video.height},position:{x:e.video.defX,y:e.video.defY},scale:e.curScale,lockAspectRatio:!0,style:{zIndex:"me"===e.video.id?10:5},disableDragging:"me"!==e.video.id,enableResizing:{top:!1,right:!1,bottom:!1,left:!1,topRight:"me"===e.video.id,bottomRight:"me"===e.video.id,bottomLeft:"me"===e.video.id,topLeft:"me"===e.video.id},onDragStart:function(e,t){u({type:"backgound_moving",value:!0})},onDragStop:function(t,a){var n=h(a.x,a.y,e.video.width,e.video.height);p(n.x,n.y,e.video.width,e.video.height)},onResizeStop:function(t,a,n,o,i){var r=parseInt(n.style.width.match(/\d+/)[0]),c=parseInt(n.style.height.match(/\d+/)[0]);p(e.video.defX,e.video.defY,r,c)}},o.a.createElement("div",Object(xe.a)({"data-v-c1f79ed4":"","data-v-6e496afa":"","data-v-7e3fe256":"",ref:a,key:e.video.id,id:v,className:"youtube-el",style:{width:"100%"}},"style",{zIndex:"me"===e.video.id?10:5}),o.a.createElement("div",{"data-v-a995c326":"","data-v-c1f79ed4":"",className:"header pointer hidden"},o.a.createElement("div",{"data-v-a995c326":"",className:"title"},"Pinned by ",e.video.username),"me"===e.video.id&&o.a.createElement("div",{onClick:function(){return t=e.video.name,u({type:"youtube_remove",name:t}),void z.getInstance().youtubeRemove({name:t});var t}},o.a.createElement("img",{"data-v-6a2f6b36":!0,className:"close",src:Ce.a,alt:"closevideo.svg"}))),o.a.createElement("div",{"data-v-c1f79ed4":"",className:"player ".concat("me"===e.video.id?null:"pointer-events-none")},o.a.createElement(ke.a,{ref:i,videoId:e.video.value,id:v,opts:{origin:"https://webrtc.bcisummit.com",playerVars:{autoplay:0,muted:0}},onPlay:"me"===e.video.id?function(a){t.then((function(a){t=a,u({type:"youtube_play",value:{name:e.video.name,videoplay:!0,curtime:t}}),z.getInstance().youtubePlay({name:e.video.name,videoplay:!0,curtime:t,videoplaying:!0})}))}:null,onPause:"me"===e.video.id?function(a){t.then((function(a){t=a,u({type:"youtube_play",value:{name:e.video.name,videoplay:!1,curtime:t}}),z.getInstance().youtubePlay({name:e.video.name,videoplay:!1,curtime:t,videoplaying:!1})}))}:null,onStateChange:function(e){t=i.current.internalPlayer.getCurrentTime()}})),"me"===e.video.id?null:o.a.createElement("img",{"data-v-c1f79ed4":"",id:m,"svg-inline":"",src:Se.a,className:"mute",onClick:function(t){return function(t){var a=document.getElementById("video_"+e.video.value);"on"===l?i.current&&(document.getElementById(m).src=Se.a,d("off"),a.muted="on"):i.current&&(document.getElementById(m).src=Ie.a,a.muted="off",d("on"))}()},alt:"youtubeAudio"})))})),Pe=(a(137),o.a.memo((function(e){var t=o.a.useRef(null),a=Object(s.b)(),n=function(n,o,i,r){a({type:"backgound_moving",value:!1}),z.getInstance().imagePosition({transform:t.current.parentNode.style.transform,name:e.image.name,width:i,height:r,defX:n,defY:o}),a({type:"image_position",value:{transform:t.current.parentNode.style.transform,name:e.image.name,width:i,height:r,defX:n,defY:o}})};function i(e,t,a,n){return e>=B.width()-a-10&&(e=B.width()-a-10),e<10&&(e=10),t>=B.height()-n-10&&(t=B.height()-n-10),t<30&&(t=30),{x:e,y:t}}if(t.current&&e.image.transform){t.current.parentNode.style.width=e.image.width+"px",t.current.parentNode.style.height=e.image.height+"px";var r=e.image.transform.match(/[+-]?\d+(?:\.\d+)?/g).map(Number),c=i(r[0],r[1],e.image.width,e.image.height),l=c.x,d=c.y;t.current.parentNode.style.transform="translate(".concat(l,"px, ").concat(d,"px)"),e.image.defX=l,e.image.defY=d}return t.current&&!e.image.transform&&e.image.defX&&(t.current.parentNode.style.transform="translate(".concat(e.image.defX,"px, ").concat(e.image.defY,"px)")),o.a.createElement(we.a,{noderef:t,size:{width:e.image.width,height:e.image.height},position:{x:e.image.defX,y:e.image.defY},scale:e.curScale,lockAspectRatio:!0,enableResizing:{top:!1,right:!1,bottom:!1,left:!1,topRight:"me"===e.image.id,bottomRight:"me"===e.image.id,bottomLeft:"me"===e.image.id,topLeft:"me"===e.image.id},disableDragging:"me"!==e.image.id,style:{zIndex:"me"===e.image.id?10:5},onDragStart:function(e,t){a({type:"backgound_moving",value:!0})},onDragStop:function(t,a){var o=i(a.x,a.y,e.image.width,e.image.height);n(o.x,o.y,e.image.width,e.image.height)},onResizeStop:function(t,a,o,i,r){var c=parseInt(o.style.width.match(/\d+/)[0]),s=parseInt(o.style.height.match(/\d+/)[0]);n(e.image.defX,e.image.defY,c,s)}},o.a.createElement("div",{ref:t,key:e.image.id},o.a.createElement("div",{className:"cus_header pointer hidden"},o.a.createElement("div",{className:"cus_title"},"Pinned by ",e.image.username),"me"===e.image.id&&o.a.createElement("div",{onClick:function(){return t=e.image.name,a({type:"image_remove",name:t}),void z.getInstance().imageRemove({name:t});var t},className:"cus_close"},o.a.createElement("img",{"data-v-6a2f6b36":!0,src:Ce.a,alt:"closevideo.svg"}))),o.a.createElement("img",{src:e.image.value,className:"image-frame",alt:"map-transparent"})))})));function Te(e){return o.a.createElement("div",{id:"div_tip",style:{position:"absolute",zIndex:100,display:"none",fontSize:"16px",backgroundColor:"#5494a6",borderRadius:10,padding:"10px"}})}var De=a(70),Re=a.n(De),Xe=a(71),Ye=a.n(Xe);a(49);var Be=function(e){Object(n.useEffect)((function(){z.getInstance().startConference(t,null,a.space,a.uname,2)}),[]);var t=Object(s.b)(),a=T.parse(e.location.search),i=Object(s.c)((function(e){return e.users})),r=Object(s.c)((function(e){return e.screens.videos})),c=Object(s.c)((function(e){return e.screens.images})),l=Object(s.c)((function(e){return e.screens.bgMoving})),d=Object(n.useState)(!1),u=Object(w.a)(d,2),m=u[0],v=u[1],f=Object(n.useState)(1),g=Object(w.a)(f,2),p=g[0],h=g[1];return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{id:"foreground_div",style:{backgroundImage:"url(".concat(Re.a,")")}},o.a.createElement(Ee,{onSetUserClose:function(e){v(e)},videoObj:r,imageObj:c,query:a}),o.a.createElement(P.b,{enablePadding:!1,enablePanPadding:!1,scalePadding:{disabled:!0},options:{disabled:l,minScale:1,maxScale:4},wheel:{step:200},pan:{paddingSize:0,padding:!0},onWheel:function(e){!function(e){h(e.scale)}(e)},doubleClick:{disabled:!0}},o.a.createElement(P.a,null,o.a.createElement("div",{id:"background_div",style:{backgroundImage:"url(".concat(Ye.a,")"),height:"100vh",width:"100vw"}},i.map((function(e){return o.a.createElement(Ne,{key:e.id,curScale:p,user:e})})),r.map((function(e){return o.a.createElement(Me,{key:e.name,video:e,curScale:p,userClose:m,room:a.space})})),c.map((function(e){return o.a.createElement(Pe,{key:e.value,image:e,curScale:p,userClose:m,room:a.space})}))))),i.map((function(e){return o.a.createElement("div",{id:"smallscreen_"+e.id,className:"screen","data-tip":!0,"data-for":e.id,key:e.id,style:{width:50,height:50,borderRadius:"50%",position:"absolute",left:0,top:0,display:"none",marginLeft:25,marginTop:25,zIndex:"me"===e.id?50:25,border:"me"===e.id?"2px solid #dcdb53":"2px solid"}})}))),o.a.createElement(Te,null))},Ae=a(72),ze=a.n(Ae),Fe=a(73),Ve=a.n(Fe);var Le=function(e){var t=Object(n.useState)(!1),a=Object(w.a)(t,2),i=a[0],r=a[1],c=Object(n.useState)(!1),s=Object(w.a)(c,2),l=s[0],d=s[1],u=Object(n.useState)(""),m=Object(w.a)(u,2),v=m[0],f=m[1],g=T.parse(e.location.search);return o.a.createElement("div",{"data-v-12a888fb":"",className:"space"},o.a.createElement("div",{"data-v-2db9ff64":"",style:{position:"absolute",right:"10%",top:"5%"},"data-v-12a888fb":""},o.a.createElement("div",{"data-v-2f32af68":""},g.space)),o.a.createElement("div",{"data-v-a74c9690":"","data-v-12a888fb":"",className:"entrance ent-div"},o.a.createElement("form",{"data-v-a74c9690":"",className:"form",onSubmit:function(t){return t.preventDefault(),d(!0),window.localStorage.setItem("o",!0),window.localStorage.setItem("t","video-meeting"),window.localStorage.setItem("r",g.space),window.localStorage.setItem("r","tryme"),window.localStorage.setItem("userName",v),void setTimeout((function(){e.history.push("/conference?space="+g.space+"&uname="+v)}),2500)}},o.a.createElement("input",{"data-v-a74c9690":"",type:"text",placeholder:"Your Name",className:"name",onChange:function(e){return function(e){e.preventDefault();var t=e.target.value;t.length>0?(r(!0),f(t)):r(!1)}(e)}}),o.a.createElement("button",{"data-v-a74c9690":"",type:"submit",disabled:!i,className:"pointer"},l?o.a.createElement(ze.a,{name:"three-bounce"}):o.a.createElement("img",{src:Ve.a,alt:"joinbtn"})))),o.a.createElement(C,null))};var Ue=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(p.a,null,o.a.createElement(h.c,null,o.a.createElement(h.a,{path:"/login",component:M}),o.a.createElement(h.a,{path:"/room",component:Le}),o.a.createElement(h.a,{path:"/conference",component:Be}),o.a.createElement(h.a,{path:"/",component:M}))))},We=Object(c.c)(g,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());r.a.render(o.a.createElement(s.a,{store:We},o.a.createElement(o.a.StrictMode,null,o.a.createElement(Ue,null))),document.getElementById("root"))},22:function(e,t,a){},26:function(e,t,a){e.exports=a.p+"static/media/closevideo.7b864b90.svg"},28:function(e,t,a){e.exports=a.p+"static/media/youtube.43fef7ea.svg"},29:function(e,t,a){e.exports=a.p+"static/media/uploadimage.a7edbc9b.svg"},34:function(e,t,a){e.exports=a.p+"static/media/logo.da4bdda8.svg"},35:function(e,t,a){e.exports=a.p+"static/media/logo-small.e1cf996c.svg"},39:function(e,t,a){e.exports=a.p+"static/media/screenshare-on.44d81ce8.svg"},40:function(e,t,a){e.exports=a.p+"static/media/stopvideo-1.e529fa66.svg"},41:function(e,t,a){e.exports=a.p+"static/media/stopaudio-1.7268da01.svg"},42:function(e,t,a){e.exports=a.p+"static/media/mic-mute.9a8a5f6e.svg"},49:function(e,t,a){},53:function(e,t,a){e.exports=a.p+"static/media/success.e50007f4.svg"},54:function(e,t,a){e.exports=a.p+"static/media/error.c4f7f08f.svg"},56:function(e,t,a){e.exports=a.p+"static/media/youtube1.3933bad6.svg"},58:function(e,t,a){e.exports=a.p+"static/media/users.78454788.svg"},59:function(e,t,a){e.exports=a.p+"static/media/screenshare-off.341a9dd8.svg"},60:function(e,t,a){e.exports=a.p+"static/media/stopvideo-0.34d55c9b.svg"},61:function(e,t,a){e.exports=a.p+"static/media/stopaudio-0.e55d1c5b.svg"},62:function(e,t,a){e.exports=a.p+"static/media/support.dc413a12.svg"},63:function(e,t,a){e.exports=a.p+"static/media/close.81170d04.svg"},69:function(e,t,a){e.exports=a.p+"static/media/mic-mute1.c0d28aa1.svg"},70:function(e,t,a){e.exports=a.p+"static/media/map-small@2x.0c2a372b.0c2a372b.png"},71:function(e,t,a){e.exports=a.p+"static/media/map-big@2x.44a3f15c.9880d0f9.png"},73:function(e,t,a){e.exports=a.p+"static/media/joinbtn.d5e1ecf0.svg"},76:function(e,t,a){e.exports=a(156)},85:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){e.exports=a.p+"static/media/logo-mark.8e118226.svg"}},[[76,1,2]]]);
//# sourceMappingURL=main.4bf213c1.chunk.js.map